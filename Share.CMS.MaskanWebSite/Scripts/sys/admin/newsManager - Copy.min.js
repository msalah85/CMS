var newsManager=function(){var n=function(){tableName="News";pKey="NewsID";gridId="itemsDataTable";gridColumns=[{mDataProp:"NewsID",bSortable:!0},{mDataProp:"Title",bSortable:!0},{mDataProp:"Short",bSortable:!0},{mDataProp:"LanguageName",bSortable:!0},{mData:function(n){return n.Active==="true"?'<i class="green fa fa-check"><\/i>':'<i class="red fa fa-times"><\/i>'},bSortable:!0},{mData:function(n){return moment(n.CreatedOnUtc).format("DD/MM/YYYY")},bSortable:!0},{bSortable:!1,mData:function(){return'<button class="btn btn-primary btn-xs edit" title="Edit"><i class="fa fa-pencil"><\/i><\/button><button class="btn btn-danger btn-xs remove" title="Delete"><i class="fa fa-trash"><\/i><\/button>'}}];DefaultGridManager.Init();$.fn.beforeSave=function(){var n=CKEDITOR.instances.Details.getData();return n===""?(commonManger.showMessage("Details field is required","Please enter news details."),!1):!0};$.fn.afterLoadDatawithdata=function(n){$("#LanguageId").select2("trigger","select",{data:{id:n.LanguageId,text:n.LanguageName}})};CKEDITOR.replace("Details");try{try{document.createElement("IMG").appendChild(document.createElement("B"))}catch(r){Image.prototype.appendChild=function(){}}var n,i=$(".PhotoUrl");i.editable({type:"image",name:"PhotoUrl",value:null,image:{btn_choose:"Change photo",droppable:!0,name:"PhotoUrl",on_error:function(t){n&&$.gritter.remove(n);t==1?n=$.gritter.add({title:"File is not an image!",text:"Please choose a jpg|gif|png image!",class_name:"gritter-error gritter-center"}):t==2&&(n=$.gritter.add({title:"File too big!",text:"Image size should not exceed 100Kb!",class_name:"gritter-error gritter-center"}))},on_success:function(){$.gritter.removeAll()}},url:function(){var t=new $.Deferred,r=i.next().find("input[type=hidden]:eq(0)").val();return!r||r.length==0?(t.resolve(),t.promise()):(setTimeout(function(){if("FileReader"in window){var r=i.next().find("img").data("thumb"),u=i.next().find("img").data("full");r&&(i.get(0).src=r);u&&$("#PhotoUrl").val(u.split(",")[1])}t.resolve({status:"OK"});n&&$.gritter.remove(n)},parseInt(Math.random()*800+800)),t.promise())},success:function(){}})}catch(r){}t()},t=function(){$(document).delegate("input[type=file]:eq(0)","change",function(n){var t=n.target.files;t&&i(t[0])});$.fn.beforeSave=function(){var n=$("#PhotoUrl").val(),t,i;if(n==="")return commonManger.showMessage("Upload faild!","Please try again by uploading image or contact system administrator."),!1;t={ID:n};i=function(n){return console.log(n),n.indexOf("Error")<=0?($("#PhotoUrl").val(n),!0):!1};dataService.callAjax("POST",JSON.stringify(t),"/api/upload/Send",i,commonManger.errorException)}},i=function(n){var t=new FileReader,i=$(".PhotoUrl:eq(0)");t.onloadend=function(){i&&i.data("base64",t.result.split(",")[1])};t.readAsDataURL(n)};return{init:n}}();newsManager.init();
