String.prototype.format=function(){for(var i,t=this,n=0;n<arguments.length;n++)i=new RegExp("\\{"+n+"\\}","gm"),t=t.replace(i,arguments[n]);return t};var newPostManager=function(){var i=$("#uploadAll"),f="/api/Upload/",o=function(){c();r()},n=0,r=function(){n=commonManger.getQueryStrs().id;var t={actionName:"Images_Properties",value:n?n:0},i=function(n){n=commonManger.decoData(n);list=n.list;list1=n.list1;list&&$(".title").text(`(${list.PropertyTitle})`);list1&&s(list1)};n&&($(".edit-me").attr("href",`PropertyAddEdit?id=${n}`),dataService.callAjax("GET",t,"/api/data/GetData",i,commonManger.errorException))},u=function(n,t){t?n.removeAttr("disabled").html('<span class="ace-icon glyphicon glyphicon-cloud"><\/span> Upload'):n.prop("disabled","disabled").text("Processing...")},w=function(){$(".ace-file-input a.remove").click()},t=function(n,t){var i='<div class="alert alert-'+(n>1?"danger":"success")+'">'+t+"<\/div>";$(".message").html(i)},s=function(n){var t=$("#divIMagesList");t.html("");$(n).each(function(n,i){var r=i.IsMain==="true",u='<li><a target="_blank" href="/public/images/'+i.MediaUrl+'" data-rel="colorbox">                    <img style="width: 150px; height: 150px" src="/public/images/_thumb/'+i.MediaUrl+'" />                    <div class="text">                        <div class="inner">'+(r?"Main":"")+'<\/div>                    <\/div>                <\/a>                    <div class="tools tools-bottom">                        <a href="javascript:void(0);" class="set-main '+(r?"hidden":"")+'" data-id="'+i.MediaUrl+'" title="'+(r?"Main":"")+'"><i class="fa fa-thumb-tack"><\/i><\/a>                        <a class="itemToDelete" href="javascript:void(0);" data-id="'+i.MediaUrl+'" title="Delete"><i class="fa fa-trash red"><\/i><\/a>                    <\/div>                <\/li>';t.append(u)}).promise().done(function(){})},b=function(){var n=$("input[type=file]").eq(0).val().replace(/.*(\/|\\)/,"");return n.split(".")[0]},k=function(n){var t=function(n){console.log(n)},i={Name:n};dataService.callAjax("POST",JSON.stringify(i),f+"Save",t,commonManger.errorException)},h=function(){var i={uRL:"/api/Upload/Save",imgs:$("span.ace-file-name.large").map(function(n,t){return $(t).data("base64")}).get(),postedSocialCallBack:function(){t(1,"Successfully uploaded images.");r()}},u={Name:i.imgs,ID:n};i.imgs&&i.imgs.length>0?dataService.callAjax("POST",JSON.stringify(u),i.uRL,i.postedSocialCallBack,commonManger.errorException):t(3,"Please select a photo(s) first, then press Upload!")},c=function(){$("#image").ace_file_input({style:"well",btn_choose:"Drop image here or click to choose",btn_change:null,no_icon:"ace-icon fa fa-picture-o",droppable:!0,thumbnail:"large",whitelist:"gif|png|jpg|jpeg",blacklist:"exe|php|asp|aspx|txt|doc",allowExt:["jpeg","jpg","png","gif","bmp"],allowMime:["image/jpg","image/jpeg","image/png","image/gif","image/bmp"],before_change:function(n){for(var r,t,u=!0,i=0;i<n.length;i++)r=n[i],t=new Image,t.onload=function(){(!t||t.height<200&&t.width<200)&&(commonManger.showMessage("Too small !!!",`The image (${r.name}) is too small, please select a large image.`),$(".ace-file-input a.remove").trigger("click"),u=!1)},t.src=URL.createObjectURL(r);return u},before_remove:function(){return!0},preview_error:function(){}}).on("change",function(){for(var i,r=$(this)[0],t=r.files,n=0;n<t.length;n++)i=t?t[n]:null,i&&l(i,n)});i.click(function(n){n.preventDefault();h()});$(document).on("click","a.itemToDelete",function(n){n.preventDefault();var t=$(this),r=function(){u(i,!1);var n=t.attr("data-id");v(n)};e(r,1)});$(document).on("click","a.set-main",function(n){n.preventDefault();var t=$(this),r=t.attr("data-id"),f=function(){u(i,!1);p(r)};e(f,2)})},e=function(n,t){var i=t===1?"Are you sure? Delete this image?":"Are you sure you want to reset this image?";if($.isFunction(n))bootbox.confirm(i,function(t){t&&n()});else return confirm(i)},l=function(n,t){var i=new FileReader;i.onloadend=function(){var n=$("span.ace-file-name:eq("+t+")");n&&n.data("base64",i.result.split(",")[1])};i.readAsDataURL(n)},a=function(n){n==="1"?(t(1,"The selected image has been deleted."),r()):t(3,"Error! while deleting image.");u(i,!0)},v=function(n){var t=`${f}Del`,i={id:n};dataService.callAjax("GET",i,t,a,commonManger.errorException)},y=function(n){n=="1"?(t(1,"The main image has been selected."),r()):t(2,"Error occured while setting main image");u(i,!0)},p=function(n){var t=f+"Main",i={id:n};dataService.callAjax("GET",i,t,y,commonManger.errorException)};return{init:o}}();newPostManager.init();